import requests
import json
from sqlalchemy import create_engine

import sys
print("more balls")

#boundary = "XXXXXXXXXXXXX"
boundary = "----WebKitFormBoundary7MA4YWxkTrZu0gW"


def lambda_handler(event, context):
	print("balls")
	url = "https://cloud.myscript.com/api/v3.0/recognition/rest/text/doSimpleRecognition.json"
	application_key = "4443cea5-ada7-4d9f-be9b-6d68f530d2e1"
	strokes = '{ "textParameter": { "language": "en_US", "textInputMode": "CURSIVE" }, "inputUnits": [ {  "textInputType": "MULTI_LINE_TEXT",  "components": [ { "type": "stroke", "x": [ 170, 169, 161, 154, 147, 142, 137, 133, 131, 128, 126, 123, 121, 120, 119, 119, 119, 119, 119, 119, 119, 119, 119, 120, 120, 121, 122, 122, 123, 123, 124, 127, 129, 132, 136, 140, 144, 150, 154, 158, 163, 165, 168, 171, 173, 174, 175, 175, 175, 173, 169, 166, 163, 161, 160, 158, 157, 156, 156, 156, 156, 155, 155, 154, 153, 152, 152, 152, 151, 151, 151, 150, 148, 147, 147, 146 ], "y": [ 146, 146, 146, 146, 146, 146, 146, 146, 147, 151, 154, 159, 162, 165, 167, 169, 170, 172, 176, 181, 189, 194, 198, 202, 205, 208, 210, 211, 212, 213, 213, 214, 215, 216, 218, 219, 219, 219, 218, 217, 214, 212, 209, 205, 203, 201, 200, 199, 197, 195, 192, 189, 188, 186, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185 ] }, { "type": "stroke", "x": [ 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 198, 198, 199, 200, 200, 201, 202, 203, 204, 206, 207, 209, 211, 212, 215, 218, 221, 223, 226, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 237, 237 ], "y": [ 145, 149, 156, 164, 170, 177, 182, 190, 193, 196, 198, 200, 201, 202, 203, 203, 205, 206, 208, 210, 212, 213, 214, 214, 214, 214, 214, 214, 213, 212, 211, 209, 208, 206, 203, 198, 193, 185, 170, 161, 151, 144, 138, 134, 132, 131, 130, 130, 134, 140, 142, 144, 144, 145, 145 ] }, { "type": "stroke", "x": [ 283, 282, 281, 280, 278, 274, 272, 268, 266, 264, 264, 264, 264, 264, 264, 262, 262, 262, 262, 262, 262, 263, 268, 274, 280, 284, 288, 290, 291, 293, 293, 294, 295, 297, 298, 299, 299, 299, 299, 299, 298, 296, 293, 289, 285, 283, 280, 276, 272, 269, 268, 267, 267, 267, 267, 267 ], "y": [ 143, 143, 143, 143, 143, 147, 149, 152, 154, 155, 156, 156, 157, 159, 162, 168, 171, 174, 175, 176, 176, 178, 179, 180, 181, 182, 183, 183, 183, 184, 186, 189, 194, 199, 202, 205, 206, 207, 207, 208, 208, 209, 210, 211, 213, 213, 213, 213, 213, 212, 211, 211, 211, 211, 210, 210 ] }  ] } ]}'

	headers = {
    'content-type': "multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW",
    'Content-Type': "application/javascript",
	'Cache-Control': "no-cache",
	}
	print("more balls")
	payload = create_multipart(boundary, application_key, strokes)
	response = requests.request("POST", url, data = payload, headers = headers)

	print(response.text)
	print(sys.version_info[0])

	return {
	'statusCode': 200,
	'body': json.dumps(response.text)
	}


def create_multipart(boundary, application_key, strokes):
	boundary_block = ("--{0}").format(boundary)
	new_line = "\r\n"

	application_key_block = ('Content-Disposition: form-data; name="applicationKey"{0}{1}{2}').format(new_line, new_line, application_key)
	#print(application_key_block)

	strokes_block = ('Content-Disposition: form-data; name="textInput"{0}{1}{2}').format(new_line, new_line, strokes)
	#print(strokes_block)

	payload = ("{0}{1}{2}{3}{4}{5}{6}{7}{8}").format(boundary_block, new_line, application_key_block, new_line, boundary_block, new_line, strokes_block, new_line, boundary_block)
	print("most balls")

	payload = "------WebKitFormBoundary7MA4YWxkTrZu0gW\r\nContent-Disposition: form-data; name=\"applicationKey\"\r\n\r\n4443cea5-ada7-4d9f-be9b-6d68f530d2e1\r\n------WebKitFormBoundary7MA4YWxkTrZu0gW\r\nContent-Disposition: form-data; name=\"textInput\"\r\n\r\n{\n  \"textParameter\": {\n    \"language\": \"en_US\",\n    \"textInputMode\": \"CURSIVE\",\n    \"subsetKnowledges\": [\"digit\"]\n  },\n  \"inputUnits\": [\n    {\n      \"textInputType\": \"MULTI_LINE_TEXT\",\n      \"components\": [\n        {\n          \"type\": \"stroke\",\n          \"x\": [\n            170,\n            169,\n            161,\n            154,\n            147,\n            142,\n            137,\n            133,\n            131,\n            128,\n            126,\n            123,\n            121,\n            120,\n            119,\n            119,\n            119,\n            119,\n            119,\n            119,\n            119,\n            119,\n            119,\n            120,\n            120,\n            121,\n            122,\n            122,\n            123,\n            123,\n            124,\n            127,\n            129,\n            132,\n            136,\n            140,\n            144,\n            150,\n            154,\n            158,\n            163,\n            165,\n            168,\n            171,\n            173,\n            174,\n            175,\n            175,\n            175,\n            173,\n            169,\n            166,\n            163,\n            161,\n            160,\n            158,\n            157,\n            156,\n            156,\n            156,\n            156,\n            155,\n            155,\n            154,\n            153,\n            152,\n            152,\n            152,\n            151,\n            151,\n            151,\n            150,\n            148,\n            147,\n            147,\n            146\n          ],\n          \"y\": [\n            146,\n            146,\n            146,\n            146,\n            146,\n            146,\n            146,\n            146,\n            147,\n            151,\n            154,\n            159,\n            162,\n            165,\n            167,\n            169,\n            170,\n            172,\n            176,\n            181,\n            189,\n            194,\n            198,\n            202,\n            205,\n            208,\n            210,\n            211,\n            212,\n            213,\n            213,\n            214,\n            215,\n            216,\n            218,\n            219,\n            219,\n            219,\n            218,\n            217,\n            214,\n            212,\n            209,\n            205,\n            203,\n            201,\n            200,\n            199,\n            197,\n            195,\n            192,\n            189,\n            188,\n            186,\n            185,\n            185,\n            185,\n            185,\n            185,\n            185,\n            185,\n            185,\n            185,\n            185,\n            185,\n            185,\n            185,\n            185,\n            185,\n            185,\n            185,\n            185,\n            185,\n            185,\n            185,\n            185\n          ]\n        },\n        {\n          \"type\": \"stroke\",\n          \"x\": [\n            197,\n            197,\n            197,\n            197,\n            197,\n            197,\n            197,\n            197,\n            197,\n            197,\n            198,\n            198,\n            199,\n            200,\n            200,\n            201,\n            202,\n            203,\n            204,\n            206,\n            207,\n            209,\n            211,\n            212,\n            215,\n            218,\n            221,\n            223,\n            226,\n            228,\n            229,\n            230,\n            231,\n            232,\n            233,\n            234,\n            235,\n            236,\n            237,\n            238,\n            238,\n            238,\n            238,\n            238,\n            238,\n            238,\n            238,\n            238,\n            238,\n            238,\n            238,\n            238,\n            238,\n            237,\n            237\n          ],\n          \"y\": [\n            145,\n            149,\n            156,\n            164,\n            170,\n            177,\n            182,\n            190,\n            193,\n            196,\n            198,\n            200,\n            201,\n            202,\n            203,\n            203,\n            205,\n            206,\n            208,\n            210,\n            212,\n            213,\n            214,\n            214,\n            214,\n            214,\n            214,\n            214,\n            213,\n            212,\n            211,\n            209,\n            208,\n            206,\n            203,\n            198,\n            193,\n            185,\n            170,\n            161,\n            151,\n            144,\n            138,\n            134,\n            132,\n            131,\n            130,\n            130,\n            134,\n            140,\n            142,\n            144,\n            144,\n            145,\n            145\n          ]\n        },\n        {\n          \"type\": \"stroke\",\n          \"x\": [\n            283,\n            282,\n            281,\n            280,\n            278,\n            274,\n            272,\n            268,\n            266,\n            264,\n            264,\n            264,\n            264,\n            264,\n            264,\n            262,\n            262,\n            262,\n            262,\n            262,\n            262,\n            263,\n            268,\n            274,\n            280,\n            284,\n            288,\n            290,\n            291,\n            293,\n            293,\n            294,\n            295,\n            297,\n            298,\n            299,\n            299,\n            299,\n            299,\n            299,\n            298,\n            296,\n            293,\n            289,\n            285,\n            283,\n            280,\n            276,\n            272,\n            269,\n            268,\n            267,\n            267,\n            267,\n            267,\n            267\n          ],\n          \"y\": [\n            143,\n            143,\n            143,\n            143,\n            143,\n            147,\n            149,\n            152,\n            154,\n            155,\n            156,\n            156,\n            157,\n            159,\n            162,\n            168,\n            171,\n            174,\n            175,\n            176,\n            176,\n            178,\n            179,\n            180,\n            181,\n            182,\n            183,\n            183,\n            183,\n            184,\n            186,\n            189,\n            194,\n            199,\n            202,\n            205,\n            206,\n            207,\n            207,\n            208,\n            208,\n            209,\n            210,\n            211,\n            213,\n            213,\n            213,\n            213,\n            213,\n            212,\n            211,\n            211,\n            211,\n            211,\n            210,\n            210\n          ]\n        }\n      ]\n    }\n  ]\n}       \"textParameter\":{\n          \"language\":\"en_US\",\n          \"textInputMode\":\"CURSIVE\"\n       },\n       \"inputUnits\":[\n          {\n             \"textInputType\":\"MULTI_LINE_TEXT\",\n             \"components\":[\n                {\n                   \"type\":\"stroke\",\n                   \"x\":[\n                      438,\n                      439,\n                      439\n                   ],\n                   \"y\":[\n                      319.5,\n                      313.5,\n                      312.5\n                   ]\n                }\n             ]\n          }\n       ]\n    }\n\r\n------WebKitFormBoundary7MA4YWxkTrZu0gW--"
	print(payload)
	return payload
